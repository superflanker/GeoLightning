

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GeoLightning.Stela package &mdash; GeoLightning 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="GeoLightning.Utils package" href="GeoLightning.Utils.html" />
    <link rel="prev" title="GeoLightning.Solvers.Mealpy package" href="GeoLightning.Solvers.Mealpy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GeoLightning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Main modules:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">GeoLightning</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="GeoLightning.html">GeoLightning package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="GeoLightning.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.GraphUtils.html">GeoLightning.GraphUtils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.HyperParameters.html">GeoLightning.HyperParameters package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.Runners.html">GeoLightning.Runners package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.Simulator.html">GeoLightning.Simulator package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.Solvers.html">GeoLightning.Solvers package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">GeoLightning.Stela package</a></li>
<li class="toctree-l4"><a class="reference internal" href="GeoLightning.Utils.html">GeoLightning.Utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GeoLightning.html#module-GeoLightning">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Constants Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="constantes.html">Global System Constants</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GeoLightning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">GeoLightning</a></li>
          <li class="breadcrumb-item"><a href="GeoLightning.html">GeoLightning package</a></li>
      <li class="breadcrumb-item active">GeoLightning.Stela package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/GeoLightning.Stela.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geolightning-stela-package">
<h1>GeoLightning.Stela package<a class="headerlink" href="#geolightning-stela-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-GeoLightning.Stela.Bounds">
<span id="geolightning-stela-bounds-module"></span><h2>GeoLightning.Stela.Bounds module<a class="headerlink" href="#module-GeoLightning.Stela.Bounds" title="Link to this heading"></a></h2>
<section id="bound-limits-generation">
<h3>Bound Limits Generation<a class="headerlink" href="#bound-limits-generation" title="Link to this heading"></a></h3>
<p>Bound Generator for Meta-Heuristic Search Spaces</p>
<section id="author">
<h4>Author<a class="headerlink" href="#author" title="Link to this heading"></a></h4>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="summary">
<h4>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h4>
<p>This module defines and computes dynamic spatial bounds for meta-heuristic algorithms
used in the geolocation of atmospheric events.</p>
<p class="rubric">Notes</p>
<p>This module is part of the activities of the discipline
EELT 7019 - Applied Artificial Intelligence, Federal University of Paraná (UFPR), Brazil.</p>
</section>
<section id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
<li><p>GeoLightning.Utils.Constants</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Bounds.gera_limites">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Bounds.</span></span><span class="sig-name descname"><span class="pre">gera_limites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pontos_clusterizados</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raio_metros</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">299792.458</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raio_maximo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">160000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sistema_cartesiano</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Bounds.html#gera_limites"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Bounds.gera_limites" title="Link to this definition"></a></dt>
<dd><p>Optimized version using Numba for generating local search bounds
around clustered points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pontos_clusterizados</strong> (<em>np.ndarray</em>) – A (N, 3) matrix with columns [lat, lon, alt], representing clustered points
in degrees (lat/lon) and meters (altitude).</p></li>
<li><p><strong>clusters</strong> (<em>np.ndarray</em>) – Array of cluster identifiers for each point in the reduced solution.</p></li>
<li><p><strong>raio_metros</strong> (<em>float</em>) – Search radius in meters around each uniquely identified solution point.</p></li>
<li><p><strong>raio_maximo</strong> (<em>float</em>) – Maximum radius in meters around each non-unique solution point.</p></li>
<li><p><strong>sistema_cartesiano</strong> (<em>bool</em>) – Indicates whether the coordinate system is Cartesian (True) or geographic (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>lb<span class="classifier">np.ndarray</span></dt><dd><p>Lower bounds of the search region for each cluster.</p>
</dd>
<dt>ub<span class="classifier">np.ndarray</span></dt><dd><p>Upper bounds of the search region for each cluster.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Bounds.gera_limites_iniciais">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Bounds.</span></span><span class="sig-name descname"><span class="pre">gera_limites_iniciais</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detections</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_alt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_alt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Bounds.html#gera_limites_iniciais"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Bounds.gera_limites_iniciais" title="Link to this definition"></a></dt>
<dd><p>Optimized version using Numba for generating initial search bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detections</strong> (<em>np.ndarray</em>) – detections array (Initial M=N)</p></li>
<li><p><strong>num_sensors</strong> (<em>np.int32</em>) – Number of sensors.</p></li>
<li><p><strong>min_lat</strong> (<em>np.float64</em>) – Minimum latitude.</p></li>
<li><p><strong>max_lat</strong> (<em>np.float64</em>) – Maximum latitude.</p></li>
<li><p><strong>min_lon</strong> (<em>np.float64</em>) – Minimum longitude.</p></li>
<li><p><strong>max_lon</strong> (<em>np.float64</em>) – Maximum longitude.</p></li>
<li><p><strong>min_alt</strong> (<em>np.float64</em>) – Minimum altitude.</p></li>
<li><p><strong>max_alt</strong> (<em>np.float64</em>) – Maximum altitude.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>lb<span class="classifier">np.ndarray</span></dt><dd><p>Lower bounds of the search region for each cluster.</p>
</dd>
<dt>ub<span class="classifier">np.ndarray</span></dt><dd><p>Upper bounds of the search region for each cluster.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-GeoLightning.Stela.Common">
<span id="geolightning-stela-common-module"></span><h2>GeoLightning.Stela.Common module<a class="headerlink" href="#module-GeoLightning.Stela.Common" title="Link to this heading"></a></h2>
<section id="stela-common-utilities">
<h3>STELA Common Utilities<a class="headerlink" href="#stela-common-utilities" title="Link to this heading"></a></h3>
<p>Common Functions of STELA Algorithms</p>
<section id="id1">
<h4>Author<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="id2">
<h4>Summary<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<p>This module provides common utilities for STELA-based
clustering, centroid estimation, and spatial likelihood evaluation.</p>
<p class="rubric">Notes</p>
<p>This module is part of the coursework for EELT 7019 - Applied Artificial Intelligence,
Federal University of Paraná (UFPR).</p>
</section>
<section id="id3">
<h4>Dependencies<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
<li><p>GeoLightning.Utils.Utils</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Common.calcular_media_clusters">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Common.</span></span><span class="sig-name descname"><span class="pre">calcular_media_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Common.html#calcular_media_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Common.calcular_media_clusters" title="Link to this definition"></a></dt>
<dd><p>Computes the average origin time and the number of detectors for each cluster.</p>
<p>This function calculates the temporal centroid (mean estimated origin time)
and the count of sensor detections associated with each spatial cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tempos</strong> (<em>np.ndarray</em>) – 1D array containing the estimated origin times for all detections.</p></li>
<li><p><strong>labels</strong> (<em>np.ndarray</em>) – 1D array containing the cluster labels assigned to each detection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>medias<span class="classifier">np.ndarray</span></dt><dd><p>Array of temporal centroids (mean origin times) for each cluster.</p>
</dd>
<dt>detectores<span class="classifier">np.ndarray</span></dt><dd><p>Array with the number of detectors associated with each cluster.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Common.computa_residuos_temporais">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Common.</span></span><span class="sig-name descname"><span class="pre">computa_residuos_temporais</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centroides_temporais</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tempos_de_origem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Common.html#computa_residuos_temporais"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Common.computa_residuos_temporais" title="Link to this definition"></a></dt>
<dd><p>Computes the temporal residuals between assigned cluster centroids and
the original event times.</p>
<p>This function calculates, for each detection, the deviation between
the centroid time of its associated cluster and its actual time of origin.
These residuals can be used to evaluate temporal coherence within clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centroides_temporais</strong> (<em>np.ndarray</em>) – Array of temporal centroids, where each entry corresponds to the
estimated central time of a cluster (in seconds).</p></li>
<li><p><strong>labels</strong> (<em>np.ndarray</em>) – Array of integer labels assigning each detection to a specific cluster.
It must be the same length as <cite>tempos_de_origem</cite>.</p></li>
<li><p><strong>tempos_de_origem</strong> (<em>np.ndarray</em>) – Array of original event times (in seconds), one per detection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of temporal residuals, where each value corresponds to the
difference between the assigned centroid time and the detection’s
original time. Has the same shape as <cite>tempos_de_origem</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-GeoLightning.Stela.DBSCAN">
<span id="geolightning-stela-dbscan-module"></span><h2>GeoLightning.Stela.DBSCAN module<a class="headerlink" href="#module-GeoLightning.Stela.DBSCAN" title="Link to this heading"></a></h2>
<section id="eelt-7019-applied-artificial-intelligence">
<h3>EELT 7019 - Applied Artificial Intelligence<a class="headerlink" href="#eelt-7019-applied-artificial-intelligence" title="Link to this heading"></a></h3>
<p>Numba-Optimized 1D DBSCAN Algorithm for Event Clustering</p>
<section id="id4">
<h4>Author<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="id5">
<h4>Summary<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<p>This module implements a one-dimensional version of the DBSCAN (Density-Based
Spatial Clustering of Applications with Noise) algorithm optimized using Numba.
It is tailored for the geolocation of atmospheric events using spatial data from
lightning detection sensors.</p>
<p class="rubric">Notes</p>
<p>This code is part of the academic activities of the course
EELT 7019 - Applied Artificial Intelligence at the Federal University of Paraná (UFPR), Brazil.</p>
</section>
<section id="id6">
<h4>Dependencies<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
<li><p>GeoLightning.Utils.Constants</p></li>
<li><p>GeoLightning.Utils.Utils</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.DBSCAN.clustering_metric">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.DBSCAN.</span></span><span class="sig-name descname"><span class="pre">clustering_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detection_time_s1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_time_s2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_tt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/DBSCAN.html#clustering_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.DBSCAN.clustering_metric" title="Link to this definition"></a></dt>
<dd><p>Computes the Spatio-Temporal Consistency Metric based on the TDOA
between two detection times and the physical distance between their
respective sensors.</p>
<p>This metric evaluates how well the observed time difference between
two detections matches the expected time difference implied by the
distance between the sensors and the signal propagation speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detection_time_s1</strong> (<em>np.float64</em>) – Detection timestamp (in seconds) from sensor s1.</p></li>
<li><p><strong>detection_time_s2</strong> (<em>np.float64</em>) – Detection timestamp (in seconds) from sensor s2.</p></li>
<li><p><strong>s1_index</strong> (<em>np.int32</em>) – Index of the first sensor in the sensor array.</p></li>
<li><p><strong>s2_index</strong> (<em>np.int32</em>) – Index of the second sensor in the sensor array.</p></li>
<li><p><strong>sensor_tt</strong> (<em>np.ndarray</em>) – Precomputed symmetric matrix containing the pairwise distances
between all sensor positions divided by the signal propagation
speed (i.e., time-of-travel between sensors), in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The absolute deviation between the observed time difference and
the expected time-of-travel between the two sensors. Lower values
indicate higher spatio-temporal consistency and, hence, greater
likelihood that the detections are from the same physical event.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.DBSCAN.dbscan">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.DBSCAN.</span></span><span class="sig-name descname"><span class="pre">dbscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_sensores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_tt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/DBSCAN.html#dbscan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.DBSCAN.dbscan" title="Link to this definition"></a></dt>
<dd><p>Main algorithm of the 1D DBSCAN clustering.</p>
<p>This function implements the DBSCAN algorithm for spatial clustering
in three-dimensional space, supporting both Cartesian and geographic coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tempos</strong> (<em>np.ndarray</em>) – Array of detection times associated with each detector</p></li>
<li><p><strong>indice_sensores</strong> (<em>np.ndarray</em>) – Array of sensor IDs associated with times</p></li>
<li><p><strong>sensor_tt</strong> (<em>np.ndarray</em>) – Association matrix with time-to-travel in light speed of the distances
between sensors</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Maximum spatial distance (epsilon) in meters for neighborhood definition.</p></li>
<li><p><strong>min_pts</strong> (<em>int</em>) – Minimum number of points required to form a valid cluster.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>labels</strong> – Array with cluster labels assigned to each point. Noise points are labeled as -1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.DBSCAN.expand_cluster">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.DBSCAN.</span></span><span class="sig-name descname"><span class="pre">expand_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_sensores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_tt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visitado</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vizinhos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/DBSCAN.html#expand_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.DBSCAN.expand_cluster" title="Link to this definition"></a></dt>
<dd><p>Expands a cluster from a core point by assigning labels to neighboring points.</p>
<p>This function performs the cluster expansion step of the DBSCAN algorithm.
It iteratively adds new points to the current cluster based on spatial proximity
and density requirements. Points are only included if they meet the minimum
density criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tempos</strong> (<em>np.ndarray</em>) – Array of detection times associated with each detector</p></li>
<li><p><strong>indice_sensores</strong> (<em>np.ndarray</em>) – Array of sensor IDs associated with times</p></li>
<li><p><strong>sensor_tt</strong> (<em>np.ndarray</em>) – Association matrix with time-to-travel in light speed of the distances
between sensors</p></li>
<li><p><strong>labels</strong> (<em>np.ndarray</em>) – Array containing the cluster labels assigned to each point.</p></li>
<li><p><strong>visitado</strong> (<em>np.ndarray</em>) – Boolean array indicating whether each point has already been visited.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – Index of the core point from which the cluster expansion starts.</p></li>
<li><p><strong>vizinhos</strong> (<em>np.ndarray</em>) – Array of indices of the initial neighboring points.</p></li>
<li><p><strong>cluster_id</strong> (<em>int</em>) – Numeric identifier of the current cluster.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Maximum spatial distance (epsilon neighborhood).</p></li>
<li><p><strong>min_pts</strong> (<em>int</em>) – Minimum number of points required to form a valid cluster.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function modifies <cite>labels</cite> and <cite>visitado</cite> in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.DBSCAN.region_query">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.DBSCAN.</span></span><span class="sig-name descname"><span class="pre">region_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_sensores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_tt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/DBSCAN.html#region_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.DBSCAN.region_query" title="Link to this definition"></a></dt>
<dd><p>Returns the temporal neighbors of a point within an epsilon window.</p>
<p>This function searches for all indices of points whose temporal values
lie within a maximum distance <cite>eps</cite> from the point with index <cite>i</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tempos</strong> (<em>np.ndarray</em>) – Array of detection times associated with each detector</p></li>
<li><p><strong>indice_sensores</strong> (<em>np.ndarray</em>) – Array of sensor IDs associated with times</p></li>
<li><p><strong>sensor_tt</strong> (<em>np.ndarray</em>) – Association matrix with time-to-travel in light speed of the distances
between sensors</p></li>
<li><p><strong>i</strong> (<em>int</em>) – Index of the central point around which neighbors are searched.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Maximum distance (temporal window) used to define neighborhood.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array containing the indices of neighboring points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-GeoLightning.Stela.LogLikelihood">
<span id="geolightning-stela-loglikelihood-module"></span><h2>GeoLightning.Stela.LogLikelihood module<a class="headerlink" href="#module-GeoLightning.Stela.LogLikelihood" title="Link to this heading"></a></h2>
<section id="log-likelihood">
<h3>Log-Likelihood<a class="headerlink" href="#log-likelihood" title="Link to this heading"></a></h3>
<p>Log-Likelihood Function - Objective Function</p>
<section id="id7">
<h4>Summary<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<p>This module defines the computation of the log-likelihood function
based on the Gaussian distribution, used as a fitness or objective
function in spatio-temporal event assignment and optimization procedures.</p>
<p>The log-likelihood is computed under the assumption of Gaussian residuals
centered at zero with known standard deviation, commonly used in
signal localization, parameter estimation, and inference models.</p>
</section>
<section id="id8">
<h4>Author<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="contents">
<h4>Contents<a class="headerlink" href="#contents" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Log-likelihood function for normal distribution</p></li>
<li><p>Fitness evaluation for Gaussian residuals</p></li>
<li><p>Likelihood gradients</p></li>
</ul>
<p class="rubric">Notes</p>
<p>This module is part of the activities of the discipline
EELT 7019 - Applied Artificial Intelligence, Federal University of Paraná (UFPR), Brazil.</p>
</section>
<section id="id9">
<h4>Dependencies<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
<li><p>GeoLightning.Utils.Constants</p></li>
<li><p>GeoLightning.Utils.Utils</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.LogLikelihood.funcao_log_verossimilhanca">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.LogLikelihood.</span></span><span class="sig-name descname"><span class="pre">funcao_log_verossimilhanca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deltas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/LogLikelihood.html#funcao_log_verossimilhanca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.LogLikelihood.funcao_log_verossimilhanca" title="Link to this definition"></a></dt>
<dd><p>Computes the log-likelihood under a standard normal distribution
with zero mean and standard deviation sigma.</p>
<p>This function evaluates the sum of log-likelihoods for a given array
of deviations, assuming they follow a Gaussian distribution N(0, σ²).</p>
<section id="formula">
<h3>Formula<a class="headerlink" href="#formula" title="Link to this heading"></a></h3>
<p>log(ℒ) = -0.5 * log(2π * σ²) - (Δ² / (2σ²))</p>
<dl class="field-list simple">
<dt class="field-odd">param deltas<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of observed deviations Δ.</p>
</dd>
<dt class="field-even">type deltas<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
<dt class="field-odd">param sigma<span class="colon">:</span></dt>
<dd class="field-odd"><p>Standard deviation σ &gt; 0.</p>
</dd>
<dt class="field-even">type sigma<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total log-likelihood value for the observed deviations.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.LogLikelihood.maxima_log_verossimilhanca">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.LogLikelihood.</span></span><span class="sig-name descname"><span class="pre">maxima_log_verossimilhanca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/LogLikelihood.html#maxima_log_verossimilhanca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.LogLikelihood.maxima_log_verossimilhanca" title="Link to this definition"></a></dt>
<dd><p>Computes the maximum log-likelihood under a standard normal distribution
with zero mean and standard deviation sigma.</p>
<p>This function evaluates the sum of log-likelihoods for a number of observations,
assuming they follow a Gaussian distribution N(0, σ²) and have a Δ = 0 each.</p>
<section id="id10">
<h3>Formula<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<p>log(ℒ) = -0.5 * log(2π * σ²) - (Δ² / (2σ²))</p>
<dl class="field-list simple">
<dt class="field-odd">param N<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of observations</p>
</dd>
<dt class="field-even">type N<span class="colon">:</span></dt>
<dd class="field-even"><p>np.int32</p>
</dd>
<dt class="field-odd">param sigma<span class="colon">:</span></dt>
<dd class="field-odd"><p>Standard deviation σ &gt; 0.</p>
</dd>
<dt class="field-even">type sigma<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total maximum log-likelihood value for the observed deviations.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.LogLikelihood.numba_clip">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.LogLikelihood.</span></span><span class="sig-name descname"><span class="pre">numba_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/LogLikelihood.html#numba_clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.LogLikelihood.numba_clip" title="Link to this definition"></a></dt>
<dd><p>Clamps a scalar value between specified lower and upper bounds.</p>
<p>This function returns the input value clipped to the interval
[<cite>min_bound</cite>, <cite>max_bound</cite>]. It is implemented using Numba for
high-performance scenarios involving scalar bound enforcement
within JIT-compiled functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – Input scalar value to be clipped.</p></li>
<li><p><strong>min_bound</strong> (<em>float</em>) – Lower bound of the valid interval.</p></li>
<li><p><strong>max_bound</strong> (<em>float</em>) – Upper bound of the valid interval.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The clipped value, satisfying min_bound &lt;= result &lt;= max_bound.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Equivalent to <cite>np.clip(value, min_bound, max_bound)</cite> for scalars,
but compatible with Numba’s <cite>nopython</cite> mode.</p></li>
<li><p>This function is particularly useful when used inside other
JIT-compiled routines where <cite>np.clip</cite> may not be supported.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-GeoLightning.Stela.Stela">
<span id="geolightning-stela-stela-module"></span><h2>GeoLightning.Stela.Stela module<a class="headerlink" href="#module-GeoLightning.Stela.Stela" title="Link to this heading"></a></h2>
<section id="stela-core-algorithm">
<h3>STELA Core algorithm<a class="headerlink" href="#stela-core-algorithm" title="Link to this heading"></a></h3>
<p>Spatio-Temporal Event Likelihood Assignment (STELA) Algorithm</p>
<section id="id11">
<h4>Summary<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<p>This module implements the STELA algorithm, designed for spatio-temporal association
of multisensory detections with simulated physical events, such as lightning strikes
or impulsive acoustic sources.</p>
<p>The algorithm integrates spatial and temporal clustering with a likelihood function
based on the consistency between the time-of-arrival (TOA) of signals and the estimated
event positions. It refines candidate solutions from multilateration, adjusts
search boundaries for meta-heuristics, and identifies plausible groupings
of detections that correspond to real-world events.</p>
<p>This pipeline is compatible with TOA-based localization methods and applicable
to geophysical sensing, radio frequency, underwater acoustics, and transient astronomy.</p>
</section>
<section id="id12">
<h4>Author<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="id13">
<h4>Contents<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>STELA Algorithm (main routine - phase one and two)</p></li>
<li><p>Temporal clustering</p></li>
<li><p>Spatial clustering and likelihood estimation</p></li>
<li><p>Search bounds generation</p></li>
</ul>
<p class="rubric">Notes</p>
<p>This module is part of the activities of the discipline
EELT 7019 - Applied Artificial Intelligence, Federal University of Paraná (UFPR), Brazil.</p>
</section>
<section id="id14">
<h4>Dependencies<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
<li><p>GeoLightning.Utils.Constants</p></li>
<li><p>GeoLightning.Utils.Utils</p></li>
<li><p>GeoLightning.Stela.LogLikelihood</p></li>
<li><p>GeoLightning.Stela.Common</p></li>
</ul>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Stela.stela_phase_one">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Stela.</span></span><span class="sig-name descname"><span class="pre">stela_phase_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempos_de_chegada</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_sensores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_tt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Stela.html#stela_phase_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Stela.stela_phase_one" title="Link to this definition"></a></dt>
<dd><p>Spatio-Temporal Event Likelihood Assignment (STELA) Algorithm - Clustering Phase.</p>
<p>This function performs the core association and filtering step based on
the spatio-temporal consistency between multisensory detections using TDOA consistency criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tempos_de_chegada</strong> (<em>np.ndarray</em>) – Array of shape (M,) with absolute signal arrival times at the sensors.</p></li>
<li><p><strong>indice_sensores</strong> (<em>np.ndarray</em>) – Array of sensor IDs associated with times</p></li>
<li><p><strong>sensor_tt</strong> (<em>np.ndarray</em>) – Association matrix with time-to-travel in light speed of the distances
between sensors</p></li>
<li><p><strong>epsilon_t</strong> (<em>float</em><em>, </em><em>optional</em>) – Temporal tolerance for spatio-temporal clustering.</p></li>
<li><p><strong>min_pts</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of points to form a valid cluster (DBSCAN requirement).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>clusters_espaciais</strong> – list of clusters of asssociated detections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Optimized with Numba for high-performance execution.</p></li>
<li><p>Compatible with multiple events and multisensor contexts.</p></li>
<li><p>Suitable for pre-processing before global optimization with genetic algorithms,
swarm intelligence, and other meta-heuristics.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="GeoLightning.Stela.Stela.stela_phase_two">
<span class="sig-prename descclassname"><span class="pre">GeoLightning.Stela.Stela.</span></span><span class="sig-name descname"><span class="pre">stela_phase_two</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solucoes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters_espaciais</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tempos_de_chegada</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pontos_de_deteccao</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sistema_cartesiano</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">299792458.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/GeoLightning/Stela/Stela.html#stela_phase_two"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GeoLightning.Stela.Stela.stela_phase_two" title="Link to this definition"></a></dt>
<dd><p>Spatio-Temporal Event Likelihood Assignment (STELA) Algorithm - Refinement Phase.</p>
<p>This function performs the position index for a candidate event position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solucao</strong> (<em>np.ndarray</em>) – Array of shape (N, 3) with candidate event positions in geographic
or Cartesian coordinates.</p></li>
<li><p><strong>clusters_espaciais</strong> (<em>np.ndarray</em>) – clusters of asssociated detections</p></li>
<li><p><strong>tempos_de_chegada</strong> (<em>np.ndarray</em>) – Array of shape (M,) with absolute signal arrival times at the sensors.</p></li>
<li><p><strong>pontos_de_deteccao</strong> (<em>np.ndarray</em>) – Array of shape (M, 3) with sensor positions, using the same coordinate system
as <cite>solucoes</cite>.</p></li>
<li><p><strong>sistema_cartesiano</strong> (<em>bool</em><em>, </em><em>optional</em>) – Indicates whether the coordinates are Cartesian (True) or geographic (False). Default is False.</p></li>
<li><p><strong>sigma_t</strong> (<em>float</em><em>, </em><em>optional</em>) – Temporal standard deviation (used in likelihood computation).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>verossimilhanca</strong> – Total log-likelihood value of the solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Optimized with Numba for high-performance execution.</p></li>
<li><p>Compatible with multiple events and multisensor contexts.</p></li>
<li><p>Suitable for pre-processing before global optimization with genetic algorithms,
swarm intelligence, and other meta-heuristics.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-GeoLightning.Stela">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-GeoLightning.Stela" title="Link to this heading"></a></h2>
<section id="stela-core-module">
<h3>STELA Core Module<a class="headerlink" href="#stela-core-module" title="Link to this heading"></a></h3>
</section>
<section id="id15">
<h3>Summary<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<p>Contains the core implementation of the STELA algorithm
(Spatio-Temporal Likelihood Estimation for Lightning Analysis),
used to identify and separate multiple atmospheric events based on
TOA (Time-of-Arrival) data.</p>
</section>
<section id="id16">
<h3>Author<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<p>Augusto Mathias Adams &lt;<a class="reference external" href="mailto:augusto&#46;adams&#37;&#52;&#48;ufpr&#46;br">augusto<span>&#46;</span>adams<span>&#64;</span>ufpr<span>&#46;</span>br</a>&gt;</p>
</section>
<section id="id17">
<h3>Submodules<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Bounds.py: spatio-tempral bounds computation.</p></li>
<li><p>Common.py: common utilities for the module.</p></li>
<li><p>Dimensions.py: Remapping of Candidate Solutions.</p></li>
<li><p>Entropy.py: Shannon Entropy computation.</p></li>
<li><p>LightDBSCAN.py: DBSCAN Algorithm using a true spatio-temporal metric</p></li>
<li><p>LogLikelihood.py: Log likelihood computation.</p></li>
<li><p>Stela.py: Core spatio-temporal likelihood computation.</p></li>
</ul>
<p class="rubric">Notes</p>
<p>This module is part of the activities of the discipline
EELT 7019 - Applied Artificial Intelligence, Federal University of Paraná (UFPR), Brazil.</p>
</section>
<section id="id18">
<h3>Dependencies<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>numba</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GeoLightning.Solvers.Mealpy.html" class="btn btn-neutral float-left" title="GeoLightning.Solvers.Mealpy package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="GeoLightning.Utils.html" class="btn btn-neutral float-right" title="GeoLightning.Utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Augusto Mathias Adams.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>